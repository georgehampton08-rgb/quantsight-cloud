# Complete Endpoint Verification Test\n# PowerShell script to test all QuantSight endpoints\n\n$BASE = "https://quantsight-cloud-458498663186.us-central1.run.app"\n\nWrite-Host \"`n\" -NoNewline\nWrite-Host \"=\" * 70 -ForegroundColor Cyan\nWrite-Host \"QUANTSIGHT COMPLETE ENDPOINT TEST SUITE\" -ForegroundColor Cyan\nWrite-Host \"=\" * 70 -ForegroundColor Cyan\nWrite-Host \"`n\"\n\n$tests = @(\n    @{Name=\"Root Endpoint\"; Url=\"$BASE/\"; Method=\"GET\"; Critical=$true},\n    @{Name=\"Health Check\"; Url=\"$BASE/health\"; Method=\"GET\"; Critical=$true},\n    @{Name=\"DB Status\"; Url=\"$BASE/admin/db-status\"; Method=\"GET\"; Critical=$true},\n    @{Name=\"Teams List\"; Url=\"$BASE/teams\"; Method=\"GET\"; Critical=$true},\n    @{Name=\"Players List\"; Url=\"$BASE/players\"; Method=\"GET\"; Critical=$true},\n    @{Name=\"Player Search\"; Url=\"$BASE/players/search?q=LeBron\"; Method=\"GET\"; Critical=$false},\n    @{Name=\"Schedule\"; Url=\"$BASE/schedule\"; Method=\"GET\"; Critical=$true},\n    @{Name=\"Injuries\"; Url=\"$BASE/injuries\"; Method=\"GET\"; Critical=$false},\n    @{Name=\"Nexus Overview\"; Url=\"$BASE/nexus/overview\"; Method=\"GET\"; Critical=$false},\n    @{Name=\"Nexus Health\"; Url=\"$BASE/nexus/health\"; Method=\"GET\"; Critical=$false},\n    @{Name=\"Nexus Cooldowns\"; Url=\"$BASE/nexus/cooldowns\"; Method=\"GET\"; Critical=$false},\n    @{Name=\"Nexus Route Matrix\"; Url=\"$BASE/nexus/route-matrix\"; Method=\"GET\"; Critical=$false},\n    @{Name=\"Matchup Lab Games\"; Url=\"$BASE/matchup-lab/games\"; Method=\"GET\"; Critical=$false},\n    @{Name=\"Usage Vacuum\"; Url=\"$BASE/usage-vacuum/analyze\"; Method=\"GET\"; Critical=$false}\n)\n\n$passed = 0\n$failed = 0\n$criticalFailed = 0\n$results = @()\n\nforeach ($test in $tests) {\n    Write-Host \"Testing: $($test.Name)\" -NoNewline -ForegroundColor White\n    Write-Host \" ... \" -NoNewline -ForegroundColor Gray\n    \n    try {\n        $stopwatch = [System.Diagnostics.Stopwatch]::StartNew()\n        $response = Invoke-RestMethod -Uri $test.Url -Method $test.Method -TimeoutSec 10 -ErrorAction Stop\n        $stopwatch.Stop()\n        $latency = $stopwatch.ElapsedMilliseconds\n        \n        Write-Host \"PASS\" -ForegroundColor Green\n        Write-Host \"  Latency: $($latency)ms\" -ForegroundColor Gray\n        \n        $passed++\n        $results += @{\n            Name = $test.Name\n            Status = \"PASS\"\n            Latency = $latency\n            Critical = $test.Critical\n        }\n    }\n    catch {\n        Write-Host \"FAIL\" -ForegroundColor Red\n        Write-Host \"  Error: $($_.Exception.Message)\" -ForegroundColor Red\n        \n        $failed++\n        if ($test.Critical) {\n            $criticalFailed++\n        }\n        \n        $results += @{\n            Name = $test.Name\n            Status = \"FAIL\"\n            Error = $_.Exception.Message\n            Critical = $test.Critical\n        }\n    }\n}\n\nWrite-Host \"`n\"\nWrite-Host \"=\" * 70 -ForegroundColor Cyan\nWrite-Host \"TEST SUMMARY\" -ForegroundColor Cyan\nWrite-Host \"=\" * 70 -ForegroundColor Cyan\n\nWrite-Host \"Total Tests: $($tests.Count)\" -ForegroundColor White\nWrite-Host \"Passed: $passed\" -ForegroundColor Green\nWrite-Host \"Failed: $failed\" -ForegroundColor $(if ($failed -eq 0) {\"Green\"} else {\"Red\"})\nWrite-Host \"Critical Failures: $criticalFailed\" -ForegroundColor $(if ($criticalFailed -eq 0) {\"Green\"} else {\"Red\"})\n\n# Show details on critical failures\nif ($criticalFailed -gt 0) {\n    Write-Host \"`n\" -NoNewline\n    Write-Host \"CRITICAL FAILURES DETECTED:\" -ForegroundColor Red\n    foreach ($result in $results) {\n        if ($result.Critical -and $result.Status -eq \"FAIL\") {\n            Write-Host \"  - $($result.Name): $($result.Error)\" -ForegroundColor Red\n        }\n    }\n}\n\n# Calculate average latency for passed tests\n$passedResults = $results | Where-Object { $_.Status -eq \"PASS\" }\nif ($passedResults.Count -gt 0) {\n    $avgLatency = ($passedResults | ForEach-Object { $_.Latency } | Measure-Object -Average).Average\n    Write-Host \"`nAverage Latency: $([math]::Round($avgLatency, 2))ms\" -ForegroundColor Cyan\n}\n\nWrite-Host \"`n\" -NoNewline\nWrite-Host \"=\" * 70 -ForegroundColor Cyan\n\nif ($criticalFailed -eq 0) {\n    Write-Host \"ALL CRITICAL TESTS PASSED!\" -ForegroundColor Green\n    exit 0\n} else {\n    Write-Host \"CRITICAL TESTS FAILED - REQUIRES ATTENTION\" -ForegroundColor Red\n    exit 1\n}\n
